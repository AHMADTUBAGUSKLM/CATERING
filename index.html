<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Survei Penilaian Catering</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    body { font-family: 'Inter', sans-serif; }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4">
  <div class="bg-white rounded-2xl shadow-xl p-8 max-w-md w-full text-center">
    <!-- Header -->
    <div class="mb-8">
      <div class="w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4">
        <span class="text-3xl">ğŸ½ï¸</span>
      </div>
      <h1 class="text-2xl font-bold text-gray-800 mb-2">Penilaian Catering</h1>
      <p class="text-gray-600">Bagaimana pengalaman Anda dengan layanan catering kami hari ini?</p>
    </div>

    <!-- Buttons -->
    <div class="space-y-4 mb-6">
      <button onclick="submitFeedback('puas')" 
        class="w-full bg-green-500 hover:bg-green-600 text-white font-semibold py-4 px-6 rounded-xl transition-all duration-200 transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center justify-center space-x-3">
        <span class="text-2xl">ğŸ˜Š</span>
        <span class="text-lg">PUAS</span>
      </button>
      
      <button onclick="submitFeedback('tidak_puas')" 
        class="w-full bg-red-500 hover:bg-red-600 text-white font-semibold py-4 px-6 rounded-xl transition-all duration-200 transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center justify-center space-x-3">
        <span class="text-2xl">ğŸ˜</span>
        <span class="text-lg">TIDAK PUAS</span>
      </button>
    </div>

    <!-- Footer -->
    <p class="text-sm text-gray-500">Terima kasih atas waktu Anda!</p>
  </div>

  <!-- Thank You Modal -->
  <div id="thankYouModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden">
    <div class="bg-white rounded-2xl p-8 max-w-sm w-full text-center">
      <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
        <span class="text-3xl">âœ…</span>
      </div>
      <h2 class="text-xl font-bold text-gray-800 mb-2">Terima Kasih!</h2>
      <p id="feedbackMessage" class="text-gray-600 mb-6"></p>
      <button onclick="closeModal()" 
        class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg">
        Tutup
      </button>
    </div>
  </div>

  <!-- Reason Modal -->
  <div id="reasonModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden">
    <div class="bg-white rounded-2xl p-6 max-w-md w-full text-center">
      <h2 class="text-xl font-bold text-gray-800 mb-4">Kenapa Anda tidak puas?</h2>
      <div class="space-y-3">
        <button onclick="submitReason('Kondisi tempat makanan (rantang)')" class="w-full bg-gray-100 hover:bg-gray-200 py-3 rounded-lg">Kondisi tempat makanan (rantang)</button>
        <button onclick="submitReason('Porsi Catering')" class="w-full bg-gray-100 hover:bg-gray-200 py-3 rounded-lg">Porsi Catering</button>
        <button onclick="submitReason('Rasa & Tekstur Makanan')" class="w-full bg-gray-100 hover:bg-gray-200 py-3 rounded-lg">Rasa & Tekstur Makanan</button>
        <button onclick="submitReason('Variasi menu / kelengkapan isi catering')" class="w-full bg-gray-100 hover:bg-gray-200 py-3 rounded-lg">Variasi menu / kelengkapan isi catering</button>
        <button onclick="submitReason('Hygienitas & Tampilan Makanan')" class="w-full bg-gray-100 hover:bg-gray-200 py-3 rounded-lg">Hygienitas & Tampilan Makanan</button>
      </div>
    </div>
  </div>

  <script>
    // GANTI URL INI dengan URL Deployment Google Apps Script Anda
    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzgbzFvVNVkm9da3Qks1h5L2VSDp_OKbqrgDqu_Y3GGYbA5HnqcJISS6tF9gjN7dHbgKA/exec';
    let pendingFeedback = null;

    function submitFeedback(rating) {
      if (rating === 'puas') {
        sendFeedback({ rating: 'Puas' });
      } else {
        pendingFeedback = { rating: 'Tidak Puas' };
        document.getElementById('reasonModal').classList.remove('hidden');
      }
    }

    function submitReason(reason) {
      if (pendingFeedback) {
        pendingFeedback.reason = reason;
        sendFeedback(pendingFeedback);
        pendingFeedback = null;
      }
      document.getElementById('reasonModal').classList.add('hidden');
    }

    function sendFeedback(feedback) {
      const modal = document.getElementById('thankYouModal');
      const message = document.getElementById('feedbackMessage');

      const feedbackData = {
        timestamp: new Date().toLocaleString('id-ID'),
        rating: feedback.rating,
        reason: feedback.reason || '',
        date: new Date().toLocaleDateString('id-ID'),
        time: new Date().toLocaleTimeString('id-ID')
      };

      fetch(GOOGLE_SCRIPT_URL, {
        method: 'POST',
        mode: 'no-cors',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(feedbackData)
      }).catch((error) => {
        console.error('Error:', error);
      });

      message.textContent = feedback.rating === 'Puas'
        ? 'Senang mendengar Anda puas dengan layanan catering kami! Data telah tersimpan di spreadsheet.'
        : `Terima kasih atas masukan Anda (${feedback.reason}). Data telah tersimpan di spreadsheet.`;

      modal.classList.remove('hidden');
    }

    function closeModal() {
      document.getElementById('thankYouModal').classList.add('hidden');
    }
  </script>
</body>
</html>
